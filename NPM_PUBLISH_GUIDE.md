# NPM å‘å¸ƒæ“ä½œæŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•å°† `ol-toolbar-ui` é¡¹ç›®å‘å¸ƒåˆ° npmã€‚

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. æ£€æŸ¥é¡¹ç›®é…ç½®

ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶å·²æ­£ç¡®é…ç½®ï¼š
- âœ… `package.json` - å·²é…ç½®å¿…è¦çš„å‘å¸ƒå­—æ®µ
- âœ… `.npmignore` - å·²åˆ›å»ºï¼Œæ’é™¤ä¸éœ€è¦å‘å¸ƒçš„æ–‡ä»¶
- âœ… `vite.config.ts` - æ„å»ºé…ç½®å·²æ­£ç¡®

### 2. æ£€æŸ¥ npm è´¦æˆ·

#### 2.1 æ£€æŸ¥æ˜¯å¦å·²ç™»å½• npm

åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š

```bash
npm whoami
```

å¦‚æœæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼Œè¯´æ˜å·²ç™»å½•ã€‚å¦‚æœæ˜¾ç¤ºé”™è¯¯ï¼Œéœ€è¦å…ˆç™»å½•ã€‚

#### 2.2 å¦‚æœæ²¡æœ‰ npm è´¦æˆ·ï¼Œéœ€è¦å…ˆæ³¨å†Œ

è®¿é—® [npm å®˜ç½‘](https://www.npmjs.com/) æ³¨å†Œè´¦æˆ·ã€‚

#### 2.3 ç™»å½• npm

åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š

```bash
npm login
```

æŒ‰æç¤ºè¾“å…¥ï¼š
- **Username**: ä½ çš„ npm ç”¨æˆ·å
- **Password**: ä½ çš„ npm å¯†ç 
- **Email**: ä½ çš„é‚®ç®±åœ°å€ï¼ˆå…¬å¼€æˆ–ç§å¯†ï¼‰

å¦‚æœå¯ç”¨äº†åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰ï¼Œè¿˜éœ€è¦è¾“å…¥ä¸€æ¬¡æ€§éªŒè¯ç ã€‚

### 3. æ£€æŸ¥åŒ…åæ˜¯å¦å¯ç”¨

åœ¨å‘å¸ƒå‰ï¼Œæ£€æŸ¥åŒ…å `ol-toolbar-ui` æ˜¯å¦å·²è¢«å ç”¨ï¼š

```bash
npm view ol-toolbar-ui
```

å¦‚æœè¿”å› 404 é”™è¯¯ï¼Œè¯´æ˜åŒ…åå¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…ä¿¡æ¯ï¼Œè¯´æ˜å·²è¢«å ç”¨ï¼Œéœ€è¦ä¿®æ”¹ `package.json` ä¸­çš„ `name` å­—æ®µã€‚

## ğŸ”¨ æ„å»ºé¡¹ç›®

### 1. å®‰è£…ä¾èµ–

ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼š

```bash
pnpm install
```

### 2. æ„å»ºé¡¹ç›®

è¿è¡Œæ„å»ºå‘½ä»¤ç”Ÿæˆå‘å¸ƒæ–‡ä»¶ï¼š

```bash
pnpm build
```

æ„å»ºå®Œæˆåï¼Œæ£€æŸ¥ `dist` ç›®å½•æ˜¯å¦ç”Ÿæˆäº†ä»¥ä¸‹æ–‡ä»¶ï¼š
- `ol-toolbar.es.js` - ES æ¨¡å—æ ¼å¼
- `ol-toolbar.umd.js` - UMD æ ¼å¼
- `index.d.ts` - TypeScript ç±»å‹å®šä¹‰æ–‡ä»¶

### 3. éªŒè¯æ„å»ºç»“æœ

æ£€æŸ¥ `dist` ç›®å½•å†…å®¹ï¼š

```bash
dir dist
```

åº”è¯¥çœ‹åˆ°æ„å»ºè¾“å‡ºçš„æ–‡ä»¶ã€‚

## ğŸ“¦ å‘å¸ƒåˆ° npm

### æ–¹æ³•ä¸€ï¼šç›´æ¥å‘å¸ƒï¼ˆæ¨èï¼‰

#### 1. æ£€æŸ¥ package.json ç‰ˆæœ¬å·

ç¡®ä¿ç‰ˆæœ¬å·ç¬¦åˆè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼ˆSemVerï¼‰ï¼š
- `1.0.0` - ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬
- é¦–æ¬¡å‘å¸ƒå¯ä»¥ä½¿ç”¨ `1.0.0`

#### 2. å‘å¸ƒåŒ…

è¿è¡Œå‘å¸ƒå‘½ä»¤ï¼š

```bash
npm publish
```

**æ³¨æ„**ï¼š
- å¦‚æœåŒ…åå·²è¢«å ç”¨ï¼Œå‘å¸ƒä¼šå¤±è´¥
- å¦‚æœæœªç™»å½•ï¼Œä¼šæç¤ºå…ˆç™»å½•
- å‘å¸ƒæˆåŠŸåï¼ŒåŒ…ä¼šç«‹å³åœ¨ npm ä¸Šå¯è§

#### 3. å‘å¸ƒåˆ°æµ‹è¯•æºï¼ˆå¯é€‰ï¼‰

å¦‚æœæƒ³å…ˆæµ‹è¯•å‘å¸ƒæµç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ npm çš„æµ‹è¯•æºï¼š

```bash
npm publish --registry=https://registry.npmjs.org/ --dry-run
```

`--dry-run` å‚æ•°ä¼šæ¨¡æ‹Ÿå‘å¸ƒè¿‡ç¨‹ï¼Œä¸ä¼šçœŸæ­£å‘å¸ƒã€‚

### æ–¹æ³•äºŒï¼šä½¿ç”¨ npm version ç®¡ç†ç‰ˆæœ¬

#### 1. æ›´æ–°ç‰ˆæœ¬å·

```bash
# ä¿®è®¢ç‰ˆæœ¬ï¼ˆ1.0.0 -> 1.0.1ï¼‰
npm version patch

# æ¬¡ç‰ˆæœ¬ï¼ˆ1.0.0 -> 1.1.0ï¼‰
npm version minor

# ä¸»ç‰ˆæœ¬ï¼ˆ1.0.0 -> 2.0.0ï¼‰
npm version major
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
- æ›´æ–° `package.json` ä¸­çš„ç‰ˆæœ¬å·
- åˆ›å»ºä¸€ä¸ª git commitï¼ˆå¦‚æœé¡¹ç›®æ˜¯ git ä»“åº“ï¼‰
- åˆ›å»ºä¸€ä¸ª git tag

#### 2. å‘å¸ƒ

```bash
npm publish
```

## ğŸ”„ æ›´æ–°å·²å‘å¸ƒçš„åŒ…

### 1. ä¿®æ”¹ä»£ç 

è¿›è¡Œå¿…è¦çš„ä»£ç ä¿®æ”¹ã€‚

### 2. æ›´æ–°ç‰ˆæœ¬å·

æ ¹æ®ä¿®æ”¹ç±»å‹é€‰æ‹©ç‰ˆæœ¬å·æ›´æ–°ï¼š

```bash
# ä¿®å¤ bugï¼ˆå‘åå…¼å®¹ï¼‰
npm version patch

# æ–°åŠŸèƒ½ï¼ˆå‘åå…¼å®¹ï¼‰
npm version minor

# é‡å¤§å˜æ›´ï¼ˆä¸å‘åå…¼å®¹ï¼‰
npm version major
```

æˆ–è€…æ‰‹åŠ¨ç¼–è¾‘ `package.json` ä¸­çš„ `version` å­—æ®µã€‚

### 3. é‡æ–°æ„å»º

```bash
pnpm build
```

### 4. å‘å¸ƒæ–°ç‰ˆæœ¬

```bash
npm publish
```

## ğŸ“ å‘å¸ƒåçš„éªŒè¯

### 1. æ£€æŸ¥åŒ…æ˜¯å¦å·²å‘å¸ƒ

è®¿é—®ï¼š`https://www.npmjs.com/package/ol-toolbar-ui`

æˆ–è€…åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š

```bash
npm view ol-toolbar-ui
```

### 2. æµ‹è¯•å®‰è£…

åœ¨å¦ä¸€ä¸ªé¡¹ç›®ä¸­æµ‹è¯•å®‰è£…ï¼š

```bash
npm install ol-toolbar-ui
```

æˆ–ä½¿ç”¨ pnpmï¼š

```bash
pnpm add ol-toolbar-ui
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. åŒ…åå·²è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š`You cannot publish over the previously published versions`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¿®æ”¹ `package.json` ä¸­çš„ `name` å­—æ®µä¸ºå…¶ä»–åç§°
- æˆ–è€…è”ç³»åŒ…çš„åŸä½œè€…

### 2. æœªç™»å½•æˆ–ç™»å½•è¿‡æœŸ

**é”™è¯¯ä¿¡æ¯**ï¼š`You must be logged in to publish packages`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
npm login
```

### 3. ç‰ˆæœ¬å·å·²å­˜åœ¨

**é”™è¯¯ä¿¡æ¯**ï¼š`You cannot publish over the previously published versions`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ›´æ–°ç‰ˆæœ¬å·ï¼ˆä½¿ç”¨ `npm version patch/minor/major`ï¼‰
- æˆ–æ‰‹åŠ¨ä¿®æ”¹ `package.json` ä¸­çš„ `version` å­—æ®µ

### 4. ç¼ºå°‘å¿…è¦å­—æ®µ

**é”™è¯¯ä¿¡æ¯**ï¼š`Package name must be lowercase` æˆ–å…¶ä»–éªŒè¯é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `package.json` æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µ
- ç¡®ä¿åŒ…åç¬¦åˆ npm å‘½åè§„èŒƒï¼ˆå°å†™ã€æ— ç©ºæ ¼ç­‰ï¼‰

### 5. æ„å»ºæ–‡ä»¶ç¼ºå¤±

**é”™è¯¯ä¿¡æ¯**ï¼šå‘å¸ƒæˆåŠŸä½†ç”¨æˆ·æ— æ³•ä½¿ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿è¿è¡Œäº† `pnpm build`
- æ£€æŸ¥ `dist` ç›®å½•æ˜¯å¦å­˜åœ¨ä¸”åŒ…å«å¿…è¦æ–‡ä»¶
- æ£€æŸ¥ `package.json` ä¸­çš„ `main`ã€`module`ã€`types` å­—æ®µæ˜¯å¦æ­£ç¡®

## ğŸ” å®‰å…¨å»ºè®®

### 1. ä½¿ç”¨ .npmignore

å·²åˆ›å»º `.npmignore` æ–‡ä»¶ï¼Œç¡®ä¿ä¸ä¼šå‘å¸ƒæ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ `.env` æ–‡ä»¶ã€å¯†é’¥ç­‰ï¼‰ã€‚

### 2. æ£€æŸ¥å‘å¸ƒå†…å®¹

å‘å¸ƒå‰å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é¢„è§ˆå°†è¦å‘å¸ƒçš„å†…å®¹ï¼š

```bash
npm pack
```

è¿™ä¼šç”Ÿæˆä¸€ä¸ª `.tgz` æ–‡ä»¶ï¼Œå¯ä»¥è§£å‹æŸ¥çœ‹å†…å®¹ã€‚

### 3. ä½¿ç”¨åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰

åœ¨ npm è´¦æˆ·è®¾ç½®ä¸­å¯ç”¨ 2FAï¼Œæé«˜è´¦æˆ·å®‰å…¨æ€§ã€‚

## ğŸ“š ç›¸å…³èµ„æº

- [npm å®˜æ–¹æ–‡æ¡£](https://docs.npmjs.com/)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ](https://semver.org/lang/zh-CN/)
- [npm åŒ…å‘½åè§„èŒƒ](https://docs.npmjs.com/cli/v10/configuring-npm/package-json#name)

## âœ… å‘å¸ƒæ£€æŸ¥æ¸…å•

å‘å¸ƒå‰è¯·ç¡®è®¤ï¼š

- [ ] å·²ç™»å½• npmï¼ˆ`npm whoami` æ˜¾ç¤ºç”¨æˆ·åï¼‰
- [ ] åŒ…åå¯ç”¨ï¼ˆ`npm view ol-toolbar-ui` è¿”å› 404ï¼‰
- [ ] `package.json` é…ç½®å®Œæ•´ï¼ˆname, version, description, author, license ç­‰ï¼‰
- [ ] å·²è¿è¡Œ `pnpm build` å¹¶ç”Ÿæˆ `dist` ç›®å½•
- [ ] `dist` ç›®å½•åŒ…å«å¿…è¦çš„æ–‡ä»¶ï¼ˆ.js, .d.tsï¼‰
- [ ] `.npmignore` å·²åˆ›å»ºå¹¶é…ç½®æ­£ç¡®
- [ ] ä»£ç å·²æµ‹è¯•ï¼ŒåŠŸèƒ½æ­£å¸¸
- [ ] ç‰ˆæœ¬å·ç¬¦åˆè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ
- [ ] README.md å·²ç¼–å†™ï¼ˆå¯é€‰ä½†æ¨èï¼‰

## ğŸš€ å¿«é€Ÿå‘å¸ƒå‘½ä»¤

å®Œæˆæ‰€æœ‰å‡†å¤‡åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¿«é€Ÿå‘å¸ƒï¼š

```bash
# 1. æ„å»ºé¡¹ç›®
pnpm build

# 2. æ£€æŸ¥æ„å»ºç»“æœ
dir dist

# 3. å‘å¸ƒåˆ° npm
npm publish
```

---

**ç¥å‘å¸ƒé¡ºåˆ©ï¼** ğŸ‰

